common:
  seed: 7
  verbose: true
  exp_dir: experiments

dataset:
  batch_size: 64
  dataset: KaggleERNDataset
  num_workers: 0
  path: /mnt/ssd/lingyus
  train_subjects: [2,6,7,11,12,13,14,16,17,18,20,21]
  dev_subjects: [1,3,4,5,8,9,10,15,19,25]
  sessions: [1,2,3,4,5]

lr_scheduler:
  select: OneCycleLR
  total_steps: 6400
  pct_start: 0.2
  max_lr: 4e-4
model:
  upstream:
    select: EEGPT_KaggleERN
    checkpoint: /home/lingyus/code/PRL/models/upstream/eegpt/checkpoint/eegpt_mcae_58chs_4s_large4E.ckpt

optimizer:
  lr: 4e-4
  select: AdamW
  weight_decay: 0.01            # 权重衰减 (L2正则化)
  

task:
  loss:
    select: CrossEntropyLoss
  select: KaggleERNTask

trainer:
  ddp_backend: gloo
  fp16: true
  total_steps: 6400
  save_interval: 64
  eval_interval: 64
  log_interval: 4
  world_size: 1
  eval_metric: BalancedAccuracy
  metrics:
    acc: {}
    bal_acc: {}
    f1:
      average: 'weighted'
    cohen_kappa: {}
    roc_auc: {}

distributed:
  backend: nccl
  world_size: 1
  rank: 0
  distributed_no_spawn: false
  cuda_visible_devices: "2,3"  