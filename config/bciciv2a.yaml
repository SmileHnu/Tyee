common:
  seed: 2021
  verbose: true
  exp_dir: experiments

dataset:
  batch_size: 72
  dataset: bciciv2a_dataset.BCICIV2ADataset
  num_workers: 4
  root_path:
    train: '/mnt/ssd/lingyus/BCICIV_2a/A09'
    val:
    test: 
  io_path:
    train: "/mnt/ssd/lingyus/tyee_bciciv2a/A09"
    val: 
    test: 
  io_mode: hdf5
  io_chunks: 750
  split: 
    select: HoldOutCross
    init_params:
      split_path: '/mnt/ssd/lingyus/tyee_bciciv2a/split/A09'
      group_by: session_id
      val_size: 0.5
      random_state: 4523
      shuffle: false
  
  offline_signal_transform:
    - select: Cheby2Filter
      l_freq: 4
      h_freq: 40
      source: eeg
      target: eeg

  online_signal_transform:
    - select: ZScoreNormalize
      mean: -0.000831605672567208
      std: 9.915488018511994
      epsilon: 0
      source: eeg
      target: eeg
        

# lr_scheduler:
#   select: WarmupCosineScheduler
#   total_epochs: 50
#   eta_min: 1e-6
#   warmup_start_lr: 0
#   warmup_epochs: 5

model:
  select: conformer.Conformer
  n_outputs: 4
  n_chans: 22
  n_times: 1000

  # select: VanillaTransformer
  # num_classes: 4
  # num_electrodes: 22
  # chunk_size: 1000
  # t_patch_size: 50

  # select: ArjunViT
  # num_electrodes: 22
  # chunk_size: 1000
  # t_patch_size: 250
  # num_classes: 4

  # select: eegnet.EEGNet
  # n_chans: 22
  # chunk_size: 1000
  # num_classes: 4
  


optimizer:
  lr:  0.0002
  select: Adam
  # weight_decay: 0.05             # 权重衰减 (L2正则化)
  # layer_decay: 0.65                # 层级学习率衰减

task:
  loss:
    select: CrossEntropyLoss
    # smoothing: 0.1
  select: bciciv2a_task.BCICIV2aTask

trainer:
  resume:  # 添加断点恢复配置
      enabled: false
      checkpoint: /home/lingyus/code/PRL/experiments/2025-01-10/14-27-21/checkpoint/checkpoint_step_8488.pt
  fp16: true
  # total_steps: 31980
  total_epochs: 2000
  update_interval: 1
  # save_interval: 40
  # eval_interval: 40
  log_interval: 20
  eval_metric:
    select: accuracy
    mode: max
  metrics: [accuracy, cohen_kappa]
    

distributed:
  backend: nccl
  world_size: 1
  distributed_no_spawn: false